<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# auth

```go
import "github.com/SuperBuker/terraform-provider-dns-he-net/client/auth"
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func addChecksum(data []byte) []byte](<#func-addchecksum>)
- [func buildSecret(a *Auth) []byte](<#func-buildsecret>)
- [func configFilePath(a *Auth, cs CookieStore) string](<#func-configfilepath>)
- [func decrypt(a *Auth, cipherData []byte) ([]byte, error)](<#func-decrypt>)
- [func encrypt(a *Auth, data []byte) ([]byte, error)](<#func-encrypt>)
- [func extractChecksum(data []byte) ([]byte, error)](<#func-extractchecksum>)
- [func initIV(iv []byte) error](<#func-initiv>)
- [type Auth](<#type-auth>)
  - [func NewAuth(user, pass, otpSecret string, storeMode CookieStore) (Auth, error)](<#func-newauth>)
  - [func (a *Auth) GetAuthForm() map[string]string](<#func-auth-getauthform>)
  - [func (a *Auth) GetCode() (string, error)](<#func-auth-getcode>)
  - [func (a *Auth) LoadCookies() ([]*http.Cookie, error)](<#func-auth-loadcookies>)
  - [func (a *Auth) SaveCookies(cookies []*http.Cookie) error](<#func-auth-savecookies>)
- [type CookieStore](<#type-cookiestore>)
- [type ErrFileChecksum](<#type-errfilechecksum>)
  - [func (e *ErrFileChecksum) Error() string](<#func-errfilechecksum-error>)
  - [func (e *ErrFileChecksum) Unwrap() []error](<#func-errfilechecksum-unwrap>)
- [type ErrFileEncoding](<#type-errfileencoding>)
  - [func (e *ErrFileEncoding) Error() string](<#func-errfileencoding-error>)
  - [func (e *ErrFileEncoding) Unwrap() []error](<#func-errfileencoding-unwrap>)
- [type ErrFileEncrypt](<#type-errfileencrypt>)
  - [func (e *ErrFileEncrypt) Error() string](<#func-errfileencrypt-error>)
  - [func (e *ErrFileEncrypt) Unwrap() []error](<#func-errfileencrypt-unwrap>)
- [type ErrFileIO](<#type-errfileio>)
  - [func (e *ErrFileIO) Error() string](<#func-errfileio-error>)
  - [func (e *ErrFileIO) Unwrap() []error](<#func-errfileio-unwrap>)
- [type Status](<#type-status>)
- [type cookieStore](<#type-cookiestore>)
  - [func dummyStore() cookieStore](<#func-dummystore>)
  - [func encryptedStore() cookieStore](<#func-encryptedstore>)
  - [func simpleStore() cookieStore](<#func-simplestore>)
  - [func storeSelector(cs CookieStore) cookieStore](<#func-storeselector>)


## Constants

```go
const otpUrl = "otpauth://totp/dns.he.net:%s?secret=%s&issuer=dns.he.net"
```

## Variables

```go
var configPath = configdir.LocalConfig("terraform-provider-dns-he-net")
```

## func [addChecksum](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L104>)

```go
func addChecksum(data []byte) []byte
```

addChecksum prepends a checksum to the given data.

## func [buildSecret](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L40>)

```go
func buildSecret(a *Auth) []byte
```

buildSecret generates secret from Auth.

## func [configFilePath](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L18>)

```go
func configFilePath(a *Auth, cs CookieStore) string
```

configFilePath returns the path to the cookie file for the given user. The cookie file is named depending on the aht username and cookie store type.

## func [decrypt](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L60>)

```go
func decrypt(a *Auth, cipherData []byte) ([]byte, error)
```

decrypt the given data using the given Auth, returns new slice and custom error.

## func [encrypt](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L82>)

```go
func encrypt(a *Auth, data []byte) ([]byte, error)
```

encrypt the given data using the given Auth, returns new slice and custom error.

## func [extractChecksum](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L114>)

```go
func extractChecksum(data []byte) ([]byte, error)
```

extractChecksum given data, returns new slice and error.

## func [initIV](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L34>)

```go
func initIV(iv []byte) error
```

initIV creates a new nonce, returns error.

## type [Auth](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L18-L23>)

```go
type Auth struct {
    User     string
    Password string
    OTPKey   *otp.Key
    store    cookieStore
}
```

### func [NewAuth](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L28>)

```go
func NewAuth(user, pass, otpSecret string, storeMode CookieStore) (Auth, error)
```

NewAuth returns an Auth struct with the given user, password and otpSecret. The OTPKey is generated from the otpSecret. The cookieStore is selected by the storeMode.

### func \(\*Auth\) [GetAuthForm](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L48>)

```go
func (a *Auth) GetAuthForm() map[string]string
```

GetAuthForm returns a map with the user and password fields.

### func \(\*Auth\) [GetCode](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L56>)

```go
func (a *Auth) GetCode() (string, error)
```

GetCode returns the OTP code generated by the OTPKey.

### func \(\*Auth\) [LoadCookies](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L61>)

```go
func (a *Auth) LoadCookies() ([]*http.Cookie, error)
```

LoadCookies returns the cookies stored in the cookieStore if they are not expired.

### func \(\*Auth\) [SaveCookies](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L83>)

```go
func (a *Auth) SaveCookies(cookies []*http.Cookie) error
```

SaveCookies saves the cookies in the cookieStore.

## type [CookieStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/cookies_store.go#L12>)

```go
type CookieStore int8
```

```go
const (
    Dummy CookieStore = iota
    Simple
    Encrypted
)
```

## type [ErrFileChecksum](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L39-L40>)

ErrFileChecksum is returned by the Reader when the file checksum fails to validate.

```go
type ErrFileChecksum struct {
}
```

### func \(\*ErrFileChecksum\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L43>)

```go
func (e *ErrFileChecksum) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrFileChecksum\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L48>)

```go
func (e *ErrFileChecksum) Unwrap() []error
```

Unwrap implements the errors.Unwrap interface.

## type [ErrFileEncoding](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L21-L23>)

ErrFileEncoding is an error returned when there is an issue decoding or encoding a file.

```go
type ErrFileEncoding struct {
    err error
}
```

### func \(\*ErrFileEncoding\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L26>)

```go
func (e *ErrFileEncoding) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrFileEncoding\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L31>)

```go
func (e *ErrFileEncoding) Unwrap() []error
```

Unwrap returns the underlying error that caused this error.

## type [ErrFileEncrypt](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L53-L55>)

ErrFileEncrypt is returned by the when the file encryption fails.

```go
type ErrFileEncrypt struct {
    err error
}
```

### func \(\*ErrFileEncrypt\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L58>)

```go
func (e *ErrFileEncrypt) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrFileEncrypt\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L63>)

```go
func (e *ErrFileEncrypt) Unwrap() []error
```

Unwrap returns the underlying error that caused this error.

## type [ErrFileIO](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L5-L7>)

ErrFileIO is an error returned when there is an issue reading from or writing to a file.

```go
type ErrFileIO struct {
    err error
}
```

### func \(\*ErrFileIO\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L10>)

```go
func (e *ErrFileIO) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrFileIO\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L15>)

```go
func (e *ErrFileIO) Unwrap() []error
```

Unwrap returns the underlying error that caused this error.

## type [Status](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/status.go#L4>)

Status indicates the current authentication status.

```go
type Status int8
```

```go
const (
    NoAuth Status = iota
    Ok
    OTP
    Unknown
    Other
)
```

## type [cookieStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/cookies_store.go#L31-L34>)

```go
type cookieStore struct {
    Load func(a *Auth) ([]*http.Cookie, error)
    Save func(a *Auth, cookies []*http.Cookie) error
}
```

### func [dummyStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/cookies_store.go#L38>)

```go
func dummyStore() cookieStore
```

Load and Save functions for a dummy cookie store. Load\(\) returns a not implemented error, Save\(\) skips the operation.

### func [encryptedStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/cookies_store.go#L87>)

```go
func encryptedStore() cookieStore
```

Load and Save functions for a encrypted and checksum validated cookie store.

### func [simpleStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/cookies_store.go#L50>)

```go
func simpleStore() cookieStore
```

Load and Save functions for a simple file\-based cookie store.

### func [storeSelector](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/cookies_store.go#L20>)

```go
func storeSelector(cs CookieStore) cookieStore
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
