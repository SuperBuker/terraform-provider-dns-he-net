<!-- Code generated by gomarkdoc. DO NOT EDIT -->

# auth

```go
import "github.com/SuperBuker/terraform-provider-dns-he-net/client/auth"
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func addChecksum(data []byte) []byte](<#func-addchecksum>)
- [func buildSecret(a *Auth) []byte](<#func-buildsecret>)
- [func configFilePath(a *Auth, cs AuthStore) string](<#func-configfilepath>)
- [func decrypt(a *Auth, cipherData []byte) ([]byte, error)](<#func-decrypt>)
- [func deserialise(bytes []byte) (string, []*http.Cookie, error)](<#func-deserialise>)
- [func encrypt(a *Auth, data []byte) ([]byte, error)](<#func-encrypt>)
- [func extractChecksum(data []byte) ([]byte, error)](<#func-extractchecksum>)
- [func initIV(iv []byte) error](<#func-initiv>)
- [func serialise(account string, cookies []*http.Cookie) ([]byte, error)](<#func-serialise>)
- [type Auth](<#type-auth>)
  - [func NewAuth(user, pass, otpSecret string, storeMode AuthStore) (Auth, error)](<#func-newauth>)
  - [func (a *Auth) GetAuthForm() map[string]string](<#func-auth-getauthform>)
  - [func (a *Auth) GetCode() (string, error)](<#func-auth-getcode>)
  - [func (a *Auth) Load() (string, []*http.Cookie, error)](<#func-auth-load>)
  - [func (a *Auth) Save(account string, cookies []*http.Cookie) error](<#func-auth-save>)
- [type AuthStore](<#type-authstore>)
- [type ErrFileChecksum](<#type-errfilechecksum>)
  - [func (e *ErrFileChecksum) Error() string](<#func-errfilechecksum-error>)
  - [func (e *ErrFileChecksum) Unwrap() []error](<#func-errfilechecksum-unwrap>)
- [type ErrFileEncoding](<#type-errfileencoding>)
  - [func (e *ErrFileEncoding) Error() string](<#func-errfileencoding-error>)
  - [func (e *ErrFileEncoding) Unwrap() []error](<#func-errfileencoding-unwrap>)
- [type ErrFileEncrypt](<#type-errfileencrypt>)
  - [func (e *ErrFileEncrypt) Error() string](<#func-errfileencrypt-error>)
  - [func (e *ErrFileEncrypt) Unwrap() []error](<#func-errfileencrypt-unwrap>)
- [type ErrFileIO](<#type-errfileio>)
  - [func (e *ErrFileIO) Error() string](<#func-errfileio-error>)
  - [func (e *ErrFileIO) Unwrap() []error](<#func-errfileio-unwrap>)
- [type ErrOTPDisabled](<#type-errotpdisabled>)
  - [func (e *ErrOTPDisabled) Error() string](<#func-errotpdisabled-error>)
  - [func (e *ErrOTPDisabled) Unwrap() []error](<#func-errotpdisabled-unwrap>)
- [type Status](<#type-status>)
- [type authStore](<#type-authstore>)
  - [func dummyStore() authStore](<#func-dummystore>)
  - [func encryptedStore() authStore](<#func-encryptedstore>)
  - [func simpleStore() authStore](<#func-simplestore>)
  - [func storeSelector(cs AuthStore) authStore](<#func-storeselector>)
- [type serialisedStore](<#type-serialisedstore>)


## Constants

```go
const otpUrl = "otpauth://totp/dns.he.net:%s?secret=%s&issuer=dns.he.net"
```

## Variables

```go
var configPath = configdir.LocalConfig("terraform-provider-dns-he-net")
```

## func [addChecksum](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L135>)

```go
func addChecksum(data []byte) []byte
```

addChecksum prepends a checksum to the given data.

## func [buildSecret](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L47>)

```go
func buildSecret(a *Auth) []byte
```

buildSecret generates secret from Auth.

## func [configFilePath](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L25>)

```go
func configFilePath(a *Auth, cs AuthStore) string
```

configFilePath returns the path to the cookie file for the given user. The cookie file is named depending on the aht username and cookie store type.

## func [decrypt](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L91>)

```go
func decrypt(a *Auth, cipherData []byte) ([]byte, error)
```

decrypt the given data using the given Auth, returns new slice and custom error.

## func [deserialise](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L79>)

```go
func deserialise(bytes []byte) (string, []*http.Cookie, error)
```

## func [encrypt](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L113>)

```go
func encrypt(a *Auth, data []byte) ([]byte, error)
```

encrypt the given data using the given Auth, returns new slice and custom error.

## func [extractChecksum](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L145>)

```go
func extractChecksum(data []byte) ([]byte, error)
```

extractChecksum given data, returns new slice and error.

## func [initIV](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L41>)

```go
func initIV(iv []byte) error
```

initIV creates a new nonce, returns error.

## func [serialise](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L65>)

```go
func serialise(account string, cookies []*http.Cookie) ([]byte, error)
```

## type [Auth](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L18-L23>)

```go
type Auth struct {
    User     string
    Password string
    OTPKey   *otp.Key
    store    authStore
}
```

### func [NewAuth](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L28>)

```go
func NewAuth(user, pass, otpSecret string, storeMode AuthStore) (Auth, error)
```

NewAuth returns an Auth struct with the given user, password and otpSecret. The OTPKey is generated from the otpSecret. The cookieStore is selected by the storeMode.

### func \(\*Auth\) [GetAuthForm](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L52>)

```go
func (a *Auth) GetAuthForm() map[string]string
```

GetAuthForm returns a map with the user and password fields.

### func \(\*Auth\) [GetCode](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L60>)

```go
func (a *Auth) GetCode() (string, error)
```

GetCode returns the OTP code generated by the OTPKey.

### func \(\*Auth\) [Load](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L69>)

```go
func (a *Auth) Load() (string, []*http.Cookie, error)
```

Load returns the cookies stored in the cookieStore if they are not expired.

### func \(\*Auth\) [Save](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/auth.go#L91>)

```go
func (a *Auth) Save(account string, cookies []*http.Cookie) error
```

Save saves the cookies in the cookieStore.

## type [AuthStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/data_store.go#L11>)

```go
type AuthStore int8
```

```go
const (
    Dummy AuthStore = iota
    Simple
    Encrypted
)
```

## type [ErrFileChecksum](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L55-L56>)

ErrFileChecksum is returned by the Reader when the file checksum fails to validate.

```go
type ErrFileChecksum struct {
}
```

### func \(\*ErrFileChecksum\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L59>)

```go
func (e *ErrFileChecksum) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrFileChecksum\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L64>)

```go
func (e *ErrFileChecksum) Unwrap() []error
```

Unwrap implements the errors.Unwrap interface.

## type [ErrFileEncoding](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L37-L39>)

ErrFileEncoding is an error returned when there is an issue decoding or encoding a file.

```go
type ErrFileEncoding struct {
    err error
}
```

### func \(\*ErrFileEncoding\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L42>)

```go
func (e *ErrFileEncoding) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrFileEncoding\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L47>)

```go
func (e *ErrFileEncoding) Unwrap() []error
```

Unwrap returns the underlying error that caused this error.

## type [ErrFileEncrypt](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L69-L71>)

ErrFileEncrypt is returned by the when the file encryption fails.

```go
type ErrFileEncrypt struct {
    err error
}
```

### func \(\*ErrFileEncrypt\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L74>)

```go
func (e *ErrFileEncrypt) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrFileEncrypt\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L79>)

```go
func (e *ErrFileEncrypt) Unwrap() []error
```

Unwrap returns the underlying error that caused this error.

## type [ErrFileIO](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L19-L21>)

ErrFileIO is an error returned when there is an issue reading from or writing to a file.

```go
type ErrFileIO struct {
    err error
}
```

### func \(\*ErrFileIO\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L24>)

```go
func (e *ErrFileIO) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrFileIO\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L29>)

```go
func (e *ErrFileIO) Unwrap() []error
```

Unwrap returns the underlying error that caused this error.

## type [ErrOTPDisabled](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L4-L5>)

ErrOTPDisabled is an error returned when the OTP is disabled.

```go
type ErrOTPDisabled struct {
}
```

### func \(\*ErrOTPDisabled\) [Error](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L8>)

```go
func (e *ErrOTPDisabled) Error() string
```

Error returns a human\-readable error message.

### func \(\*ErrOTPDisabled\) [Unwrap](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/errors.go#L13>)

```go
func (e *ErrOTPDisabled) Unwrap() []error
```

Unwrap implements the errors.Unwrap interface.

## type [Status](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/status.go#L4>)

Status indicates the current authentication status.

```go
type Status int8
```

```go
const (
    NoAuth Status = iota
    Ok
    OTP
    Unknown
    Other
)
```

## type [authStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/data_store.go#L30-L33>)

```go
type authStore struct {
    Load func(a *Auth) (string, []*http.Cookie, error)
    Save func(a *Auth, account string, cookies []*http.Cookie) error
}
```

### func [dummyStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/data_store.go#L37>)

```go
func dummyStore() authStore
```

Load and Save functions for a dummy cookie store. Load\(\) returns a not implemented error, Save\(\) skips the operation.

### func [encryptedStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/data_store.go#L80>)

```go
func encryptedStore() authStore
```

Load and Save functions for a encrypted and checksum validated cookie store.

### func [simpleStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/data_store.go#L49>)

```go
func simpleStore() authStore
```

Load and Save functions for a simple file\-based cookie store.

### func [storeSelector](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/data_store.go#L19>)

```go
func storeSelector(cs AuthStore) authStore
```

## type [serialisedStore](<https://github.com/SuperBuker/terraform-provider-dns-he-net/tree/master/common/client/auth/blob/master/client/auth/store_utils.go#L18-L21>)

```go
type serialisedStore struct {
    Account string         `json:"account"`
    Cookies []*http.Cookie `json:"cookies"`
}
```



Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
